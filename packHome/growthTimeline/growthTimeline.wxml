<global-background>
  <custom-navbar title="ormkornnaphat" showBack="{{true}}" showHome="{{false}}"></custom-navbar>
  <view class="container" style="margin-top: {{navBarHeight}}px;height:calc(100vh - {{navBarHeight}}px);">
    <image src="cloud://cloud1-5gzybpqcd24b2b58.636c-cloud1-5gzybpqcd24b2b58-1387507403/ormmm/陈奥/e1dd18471861da1311f9643a7f85e3f1.jpg" lazy-load mode="widthFix" class="star-background-image"></image>
    <!-- 时间线容器 -->
    <scroll-view class="timeline-container" scroll-y="true" bindscrolltolower="onScrollToLower" wx-if="{{showBg}}">
      <!-- 垂直时间线 -->
      <view class="vertical-timeline">
        <block wx:for="{{timelineData}}" wx:key="id">
          <!-- 左侧时间点 -->
          <view class="timeline-item left" wx:if="{{index % 2 === 0}}" data-index="{{index}}">
            <view class="timeline-content" bindtap="onTapTimelineContent" data-index="{{index}}">
              <view class="timeline-date">{{item.year}} {{item.month}}</view>
              <view class="timeline-title">{{item.title}}</view>
              <view class="timeline-desc">{{item.description}}</view>
            </view>
            <view class="timeline-marker" bindtap="onTapTimelineMarker" data-index="{{index}}"></view>
          </view>
          <!-- 右侧时间点 -->
          <view class="timeline-item right" wx:else data-index="{{index}}">
            <view class="timeline-marker" bindtap="onTapTimelineMarker" data-index="{{index}}"></view>
            <view class="timeline-content" bindtap="onTapTimelineContent" data-index="{{index}}">
              <view class="timeline-date">{{item.year}} {{item.month}}</view>
              <view class="timeline-title">{{item.title}}</view>
              <view class="timeline-desc">{{item.description}}</view>
            </view>
          </view>
          <!-- 时间点详情弹窗 -->
          <view class="detail-modal {{showDetailModal && currentDetailIndex === index ? 'show' : ''}}">
            <view class="detail-content">
              <view class="detail-header">
                <text class="detail-title">{{item.title}}</text>
                <view class="close-btn" bindtap="onCloseDetail">×</view>
              </view>
              <view class="detail-body">
                <text class="detail-time">{{item.year}} {{item.month}}</text>
                <text class="detail-description">{{item.description}}</text>
              </view>
            </view>
          </view>
        </block>
      </view>
      <!-- 底部提示 -->
      <!-- <view class="footer-tip">滚动到底部，给Orm送上你的祝福</view> -->
    </scroll-view>
    <!-- 祝福输入弹窗 -->
    <view class="blessing-modal {{showBlessingModal ? 'show' : ''}}">
      <view class="blessing-content">
        <view class="blessing-header">
          <text class="blessing-title">To: ORM</text>
          <view class="close-btn" bindtap="onCloseBlessingModal">×</view>
        </view>
        <view class="blessing-body">
          <button class="submit-btn" bindtap="onSubmitBlessing">谢谢你成为orm</button>
        </view>
      </view>
    </view>
    <!-- 心脏爆炸特效 -->
    <view class="heart-explosion-container {{showHeartExplosion ? 'show' : ''}}">
      <view class="heart-center {{showHeartExplosion ? 'heart-animate' : ' '}}">
        谢谢你那个夏天出现在我面前❤
      </view>
      <block wx:for="{{heartParticles}}" wx:key="index">
        <view class="heart-particle {{item.show ? 'particle-animate' : ''}}" style="--start-x: {{item.startX}}px; --start-y: {{item.startY}}px; --end-x: {{item.endX}}px; --end-y: {{item.endY}}px; --duration: {{item.duration}}ms; --delay: {{item.delay}}ms; background: {{item.gradient}};">
          {{item.text}}
        </view>
      </block>
    </view>
  </view>
</global-background>